eel.expose(setTable);eel.expose(updateAddFormRow);eel.expose(createHead);eel.expose(createLinkedTables);eel.expose(clearLinkedTable);eel.expose(clearHead);eel.expose(clearTable);eel.expose(editTableRow);eel.expose(checkedRadio);eel.expose(createFormLinkedTable);function tableAllDataTable(e){return tableAll.get(e).DataTable}function setTable(e,l,t,a,n,o,s,r,i,c,d,b,p,u,f,m,T,h,g,w,_){console.log("setTable :: INIT");try{tableAll.set(l,{DataTable:$("#"+l+"_table").DataTable({order:[],data:t,deferRender:!0,scrollX:!0,scrollY:500,scrollCollapse:!0,scroller:g,autoWidth:!1,aLengthMenu:[_?[-1]:[15,20,35,50,100,200,-1],_?["Todos"]:[15,20,35,50,100,200,"Todos"]],fixedColumns:w,aoColumnDefs:[{bSortable:!n,aTargets:[0]},{targets:s,orderable:!1,visible:!1},{targets:h,orderable:!1},{className:"dt-head-center",targets:"_all"},{className:"dt-body-center",targets:"_all"},{data:"DT_RowIndex"}],select:{style:n?"multi":"single",toggleable:!g},pagingType:"simple_numbers",language:{decimal:",",thousands:".",select:{rows:"selec. %d"},lengthMenu:"_MENU_",zeroRecords:"Sem Registros",info:"_TOTAL_ linhas",infoEmpty:"",infoFiltered:"(Total: _MAX_)",sLoadingRecords:"Carregando...",sProcessing:"Processando...",sSearch:"",oPaginate:{sNext:"→",sPrevious:"←",sFirst:"Primeiro",sLast:"Ultimo"},sSortAscending:": Ordenar colunas de forma ascendente",sSortDescending:": Ordenar colunas de forma descendente"}}),selected:n,duplicates:o,linkedTable:r,index:m,deleteRow:T}),n&&jQuery(function(){$("#"+l+"_table tbody").on("click","tr",function(){$(this).toggleClass("selected")})});let v="";if(i&&!_&&(v+=`<button type="button" class="btn btn-outline-danger btn-sm col ml-1 mr-1 mt-1" style="max-heigh:30px; white-space: nowrap;overflow: hidden;" onclick="dellTableRow(${e}, '${l}', true, false);"><i class="fa fa-trash nowrap" aria-hidden="true"></i><span class="btn-text ml-2">Deletar</span></button>`),n&&!_&&(v+=`<button type="button" class="btn btn-outline-primary btn-sm col ml-1 mr-1 mt-1" style="max-heigh:30px; white-space: nowrap;overflow: hidden;" onclick="invertSelection('${l}');"><i class="fa fa-retweet" aria-hidden="true"></i><span class="btn-text ml-2">Inverter</span></button><button type="button" class="btn btn-outline-primary btn-sm col ml-1 mr-1 mt-1" style="max-heigh:30px; white-space: nowrap;overflox: hidden;" onclick="clearSelection('${l}');"><i class="fa fa-eraser nowrap" aria-hidden="true"></i><span class="btn-text ml-2">Desselecionar</span></button>`),c&&!_&&(v+=`<button type="button" class="btn btn-outline-dark btn-sm col ml-1 mr-1 mt-1" style="max-heigh:30px; white-space: nowrap;overflow: hidden;" onclick="importTable(${e}, '${l}', '${f}');"><i class="fa fa-upload nowrap" aria-hidden="true"></i><span class="btn-text ml-2">Importar</span></button>`),d&&!_&&(v+=`<button type="button" class="btn btn-outline-primary btn-sm col ml-1 mr-1 mt-1" style="max-heigh:30px; white-space: nowrap;overflow: hidden;" onclick="editTable(${e}, '${l}','${p}');"><i class="fa fa-pencil-square nowrap" aria-hidden="true"></i><span class="btn-text ml-2">Editar</span></button>`),b&&!_&&(v+=`<button type="button" class="btn btn-outline-success btn-sm col ml-1 mr-1 mt-1" style="max-heigh:30px; white-space: nowrap;overflow: hidden;" onclick="exportTable(${e}, '${l}','${u}', '${a}');"><i class="fa fa-share nowrap" aria-hidden="true"></i><span class="btn-text ml-2">Exportar</span></button>`),$(`#${l}_table_wrapper > div:nth-child(1)`).after(`<div class="row">${v}</div>`),$("#principal").addClass("principal"),$(`#${l}_table_filter`).children().children().attr("placeholder","pesquisar..."),g&&($(`#${l}_table_length`).css("display","none"),$(`#${l}_table_paginate`).css("display","none")),l.indexOf("_x")>=0){let e=$(`#${l.replace("_x","")}Linked`).width()/7;$(`#${l}_table_filter`).children().children().css("width",e+"px")}else if(l.indexOf("_y")>=0){let e=$(`#${l.replace("_y","")}Linked`).width()/7;$(`#${l}_table_filter`).children().children().css("width",e+"px")}else{let e=$(`#${l}`).width()/4;$(`#${l}_table_filter`).children().children().css("width",e+"px")}_?($(`#${l}_table_length`).addClass("d-none"),$(`#${l}_table_paginate`).addClass("d-none"),$(`#${l}_table_info`).addClass("d-none")):($(`#${l}_table_paginate`).parent().removeClass("col-md-5"),$(`#${l}_table_paginate`).parent().parent().addClass("row"),$(`#${l}_table_paginate`).parent().removeClass("col-md-7"),$(`#${l}_table_paginate`).addClass("col"),$(`#${l}_table_info`).parent().removeClass("col-md-5"),$(`#${l}_table_info`).addClass("col"),$($.fn.dataTable.tables(!0)).DataTable().columns.adjust())}catch(e){console.log("setTable :: "+e)}tableAllDataTable(l).scroller().pixelsToRow($(".dataTables_scrollBody").scrollTop())}function sleep(e){for(var l=(new Date).getTime();(new Date).getTime()<l+e;);}function editTableCheck(e,l,t){console.log("editTableCheck :: INIT");let a=getTableAll(l,!0);window.eel.edit_table_check(e,l,a,t)}function importTable(e,l,t){console.log("importTable :: INIT"),window.eel[t](e,l,tableAll.get(l).selected,tableAll.get(l).linkedTable)}function editTable(e,l,t){console.log("editTable :: INIT");let a=getTableAll(l,!1,!0,!0);window.eel[t](e,l,a,tableAll.get(l).linkedTable)}function createTableHTML(e,l,t){console.log("createTableHTML :: INIT");let a=`<div class="col-sm-${t} col-12 table-responsive justify-content-center mb-5"><div class="col text-center"><h2>${l}</h2></div><table id="${e}_table" class="table table-hover table-striped table-sm text-nowrap display nowrap""><thead class="thead-dark"></thead><tbody></tbody></table></div>`;-1===$("#"+e).html().indexOf(`${e}_table`)&&$("#"+e).append(a)}function updateAddFormRow(e,l){if(tableAll.has(e)){if(tableAll.get(e).selected){let e=Array();for(const t of l)t.unshift(""),e.push(t);l=e}tableAllDataTable(e).rows.add(l).draw().select()}}function createHead(e,l,t,a,n){console.log("createHead :: INIT"),createTableHTML(l,a,n);let o="";o=t?`<th style="width: 20px!important"><input class='ml-2' type='checkbox' id='${l}Check' onclick='checkAll("${l}")'><label for='${l}Check'></label></th>`:"";for(const l of e)o+="<th>"+l+"</th>";$("#"+l+"_table thead").append("<tr>"+o+"</tr>")}function loadBackUpTable(e,l){eel.load_backup_table(e,l,tableAll.get(l+"_y").index)}function saveBackUpTable(e,l){eel.save_backup_table(e,l)}function createLinkedTables(e,l,t){null==t&&(t=12);let a=`<div id="${l}_x" class="col table-responsive justify-content-center"></div>`,n=`<div id="${l}_y" class="col table-responsive justify-content-center"></div>`,o=`<div class="align-items-center justify-content-center" style="margin-top: 10%" id="${l}_buttons"><div class="mt-1"><button class="btn btn-primary fa fa-save" style="font-size:10px" onclick="saveBackUpTable(${e}, '${l}')" title="Recarregar todas as transações iniciais"></button></div><div class="mt-1"><button class="btn btn-primary fa fa-refresh" style="font-size:10px" onclick="loadBackUpTable(${e}, '${l}')" title="Recarregar todas as transações iniciais"></button></div><div class="mt-3"><button class="btn btn-dark fa fa-angle-right" style="width:35px;font-size:15px" title="Enviar transações selecionadas para DIREITA" onclick="switchTable(${e}, '${l}', 'right', false)"></button></div><div class="mt-1"><button class="btn btn-dark fa fa-angle-left" style="width:35px;font-size:15px" title="Enviar transações selecionadas para ESQUERDA" onclick="switchTable(${e}, '${l}', 'left', false)"></button></div><div class="mt-3"><button class="btn btn-dark fa fa-angle-double-right" style="width:35px;font-size:15px" title="Enviar TODAS as transações para DIREITA" onclick="switchTable(${e}, '${l}', 'right', true)"></button></div><div class="mt-1"><button class="btn btn-dark fa fa-angle-double-left" style="width:35px;font-size:15px" title="Enviar TODAS as transações para ESQUERDA" onclick="switchTable(${e}, '${l}', 'left', true)"></button></div></div>`,s=`<div class="col-sm-${t} col-12"><div id="${l}Linked" class="row">${a}${o}${n}</div></div>`;$("#"+l).append(s)}function clearLinkedTable(e){console.log("clearLinkedTable :: INIT");try{$(`#${e}Linked`).remove()}catch(e){console.log("clearLinkedTable :: "+e)}}function clearHead(e){console.log("clearHead :: INIT");try{for(var l=document.getElementById(e+"_table").tHead;l.firstChild;)l.removeChild(l.firstChild)}catch(e){console.log("clearHead :: "+e)}}function clearTable(e){console.log("clearTable :: INIT");try{tableAll.has(e)&&(tableAllDataTable(e).clear(),tableAllDataTable(e).destroy())}catch(e){console.log("clearTable :: "+e)}}function toObject(e,l){const t=Object.fromEntries(e.map((e,t)=>[e,l[t]]));return t}function switchTable(e,l,t,a){if(console.log("switchTable :: INIT"),!tableAll.has(l+"_x")&&!tableAll.has(l+"_y"))return;let n=l+("right"==t?"_x":"_y"),o=l+("right"==t?"_y":"_x"),s=getTableAll(n,a,!1,!0),r=tableAll.get(n).deleteRow;eel.update_linked_table(e,n,removeFirstColumn(n,s),tableAll.get(n).index,r),r&&(a?tableAll.get(n).DataTable.rows().remove().draw():tableAll.get(n).DataTable.rows({selected:!0}).remove().draw());let i="right"==t?"1":"0";if(s.forEach(e=>{e[e.length-1]=i}),tableAll.get(o).index){let e=0,l=tableAllDataTable(o).rows().data().toArray().length;for(let e=0;e<l;e++)tableAllDataTable(o).cell({row:e,column:tableAll.get(o).selected?1:0}).data(String(e)).draw();s=s.map(function(l){return index=tableAllDataTable(o).rows().data().toArray().length,0===index&&0===e?l[tableAll.get(n).selected?1:0]="0":l[tableAll.get(n).selected?1:0]=index+e,e+=1,l})}if(tableAll.get(o).selected){let e=Array();for(const l of s)l.unshift(""),e.push(l);s=e}else s=removeFirstColumn(n,s);r&&tableAll.get(o).index||tableAll.get(o).DataTable.rows.add(s).draw().select(),$($.fn.dataTable.tables(!0)).DataTable().columns.adjust()}function modeOfUpdate(e){let l=tableAllDataTable(e).rows({selected:!0}).count();return modeSelect=l>3e4,modeSelect}function getFirstRowTable(e){let l=tableAllDataTable(e).rows(0).data()[0];if(l)return tableAll.get(e).selected&&(l=l.slice(1)),l}function editTableRow(e,l,t){if(null!=t&&""!=t||(t=tableAllDataTable(e).rows({selected:!0}).indexes()[0]),tableAll.get(e).selected){let e=Array();for(const t of l)t.unshift(""),e.push(t);l=e}var a=tableAllDataTable(e).scroller().pixelsToRow($(".dataTables_scrollBody").scrollTop());tableAllDataTable(e).row(t).data(l[0]).draw().scroller.toPosition(a,!1)}function dellTableRow(e,l,t,a){if(console.log("dellTableRow :: INIT"),!tableAll.has(l))return;null==t&&(t=!0);let n=modeOfUpdate(l),o=tableAll.get(l).linkedTable,s=tableAll.get(l).selected,r=getFirstRowTable(l);var i=tableAllDataTable(l).scroller().pixelsToRow($(".dataTables_scrollBody").scrollTop());n?dt=getTableAll(l,a,!0,!1):(dt=getTableAll(l,a,!0,!0),a?tableAllDataTable(l).rows().remove().draw().scroller.toPosition(i,!1):tableAllDataTable(l).rows({selected:!0}).remove().draw().scroller.toPosition(i,!1)),eel.dell_rows(e,l,dt,s,n,o,r,t)}function invertSelection(e){if(console.log("invertSelection :: INIT"),!tableAll.has(e))return;let l=tableAllDataTable(e).rows({selected:!1});tableAllDataTable(e).rows({selected:!0}).deselect(),l.select()}function clearSelection(e){console.log("clearSelection :: INIT"),tableAllDataTable(e).rows().deselect()}function getTableAll(e,l,t,a){console.log("getTableAll :: INTI");let n=Array();return n=l?tableAllDataTable(e).rows().data().toArray():tableAllDataTable(e).rows({selected:a}).data().toArray(),tableAll.get(e).selected&&t&&(n=removeFirstColumn(e,n)),n}function removeFirstColumn(e,l){return tableAll.get(e).selected&&(newTable=l.map(function(e){return e.slice(1)}),l=newTable),l}function getHeaderAll(e){console.log("getHeaderAll :: INIT");let l=tableAllDataTable(e).columns().header().toArray().map(e=>e.innerText);return tableAll.get(e).selected&&(l=l.slice(1)),l}function exportTable(e,l,t,a){"default"!=t?window.eel[t](e,l,a):exportExcel(l,a)}function exportExcel(e,l){if(console.log("exportExcel :: INIT"),!tableAll.has(e))return;let t=tableAllDataTable(e).rows({selected:!0}).count();t>5e5&&showModal("excelExport","Tamanho da tabela muito grande para ser exportado!","exclamation-triangle","Atenção");let a=getTableAll(e,!0,!0),n=getHeaderAll(e);a.unshift(n);let o=XLSX.utils.book_new(),s=XLSX.utils.aoa_to_sheet(a);var r=[];for(const e of n)r.push({wch:e.length+5});s["!cols"]=r,XLSX.utils.book_append_sheet(o,s,"Planilha1");let i=XLSX.write(o,{bookType:"xlsx",type:"array"}),c=(""!=l.replaceAll(" ","")?l:"dados")+".xlsx";saveAs(new Blob([i],{type:"application/octet-stream"}),c)}function select(e){console.log("select :: INIT"),tableAllDataTable(e).rows({page:"current"}).select()}function deselect(e){console.log("deselect :: INIT"),tableAllDataTable(e).rows({page:"current"}).deselect()}function checkAll(e){if(console.log("checkAll :: INIT"),tableAll.has(e)){var l=document.getElementById(e+"Check");l.checked?select(e):deselect(e)}return!1}function checkedRadio(e,l){$(`#${e}_${l[0]}`).prop("checked",!0)}function createFormLinkedTable(e,l,t,a){if(console.log("createFormLinkedTable :: INIT"),-1!=$("#"+t).html().indexOf(t))return;let n=`<form class="form-inline mt-3 border rounded"><div class="container-fluid form-group justify-content-between"><div class="form-group col-9"><label class="col-1 col-form-label" >Cartão:</label><div class="col-3"><div class="input-group"><div class="input-group-prepend"><div class="input-group-text"><input type="checkbox" class="form-check-input m-0" id="${t}_flag" title="Selecione para capturar todas as contas"></div></div><input type="text" class="form-control form-control-sm text-center" id="${t}_input" title="Selecione para capturar todas as contas" onclick="inputNumbers('${t}_input')" maxlength="19"></div><label class="col-1 col-form-label text-nowrap">Ciclo De:</label><div class="col-1" id="${t}_ini_cycle_content">${newSelectOption(t+"_ini_cycle",[...Array(13).keys()],0,"Ciclo inicio")}</div><label class="col-1 col-form-label">Até:</label><div class="col-1" id="${t}_end_cycle_content">${newSelectOption(t+"_end_cycle",[...Array(13).keys()],12,"Ciclo fim")}</div><div class="form-check-inline" id="${t}_end_cycle_content"><input class="ml-5" type="radio" name="${t}_radio" id="${t}_f"  value="fraude"  title="Cliente contesta despesas por motivo de FRAUDE" onclick="eel.set_reasons(${e}, '${l}', 'fraude')"></input><label class="ml-2" for="${t}_f">Fraude</label><input class="ml-2" type="radio" name="${t}_radio" id="${t}_c" value="controversia" title="Cliente contesta despesas por motivo de CONTROVÉRSIA" onclick="eel.set_reasons(${e}, '${l}', 'controversia', 'controversia')"></input><label class="ml-2" for="${t}_c">Controvérsia</label></div></div><div class="form-group "><button type="button" class="btn btn-dark btn-sm" onclick="filterLinkedTable(${e}, '${l}', '${t}')"><i class="fa fa-external-link-square mr-2" aria-hidden="true"></i>${a}</button></div></div></form>`;$("#"+t).append(n)}function filterLinkedTable(e,l,t){console.log("filterLinkedTable :: INIT");let a=$("#"+t+"_input").val();null==a&&(a=""),validateCreditCardNumber(a)?(flagKey=$(`#${t}_flag`).is(":checked"),intCycle=$(`#${t}_ini_cycle`).val(),endCycle=$(`#${t}_end_cycle`).val(),pythonUsers(eel.filter_linked_table,["b2k"],[e,l,a,intCycle,endCycle,flagKey])):showModal("modal","Número de cartão inválido!","exclamation-triangle","Atenção")}tableAll=new Map,setSelected=!1,jQuery.extend(jQuery.fn.dataTableExt.oSort,{"numeric-comma-pre":function(e){var l=parseFloat(e.toString().replace(/[^\d\,\-]/g,"").replace(",",".")),t=e.toString().indexOf("(")>=0?-1:1;return l*t},"numeric-comma-asc":function(e,l){return e<l?-1:e>l?1:0},"numeric-comma-desc":function(e,l){return e<l?1:e>l?-1:0}});